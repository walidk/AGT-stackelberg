procedure optimalNE(N,r)
Inputs: Parallel network, N, of size N; demand r
Outputs: Optimal flow/mode vectors (X,M)

for i $\in$ {1,...,N}:
    let (X,M) = freeFlowConfig(N,r,i)
    if X(i) $\in$ [0,$c_i$]:
       return (X,M)
return No-Solution


procedure freeFlowConfig(N,r,j):
Inputs: network N, demand r, free flow link index j
Outputs: flow/mode configuration (X,M)

for i $\in$ {1,...,N}:
    if i < j:
       X(i) = $\hat{x}_{i,j}$, M(i) = 1
    elseif i == j:
       X(i) = r - $\sum_{k<j}$ X(K), M(i) = 0
    else:
       X(i), M(i) = 0
return (X,M)